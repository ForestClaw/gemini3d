<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="GEMINI3D is a modular ionospheric model that incorporates kinetic models such as Fang, GLOW.">
    
    <meta name="author" content="Matthew Zettergren
Guy Grubbs
Michael Hirsch" >
    <link rel="icon" href="../favicon.png">

    <title>gemini.f90 &ndash; GEMINI3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">GEMINI3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
    <li><a href="../blockdata/gtd7bk.html">Block Data</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../blockdata/gtd7bk.html">Block Data</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>gemini.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.8% of total for source files.">244 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/gemini.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">gemini.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-0">Programs</a></h3></div>
  <div id="progs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/gemini3d.html">Gemini3D</a>
      
    </div>
  </div>
</div>

















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/gemini.f90.html#src">gemini.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~gemini.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilegeminif90EfferentGraph" width="641pt" height="746pt"
 viewBox="0.00 0.00 641.00 746.44" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~gemini.f90~~EfferentGraph" class="graph" transform="scale(.6892 .6892) rotate(0) translate(4 1078.9778)">
<title>sourcefile~~gemini.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1078.9778 926,-1078.9778 926,4 -4,4"/>
<!-- sourcefile~gemini.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~gemini.f90</title>
<polygon fill="none" stroke="#000000" points="922,-644.8253 860,-644.8253 860,-620.8253 922,-620.8253 922,-644.8253"/>
<text text-anchor="middle" x="891" y="-630.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">gemini.f90</text>
</g>
<!-- sourcefile~multifluid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~multifluid.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/multifluid.f90.html" xlink:title="multifluid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="824,-644.8253 751,-644.8253 751,-620.8253 824,-620.8253 824,-644.8253"/>
<text text-anchor="middle" x="787.5" y="-630.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">multifluid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~multifluid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~multifluid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M859.9466,-632.8253C851.9007,-632.8253 843.0557,-632.8253 834.3937,-632.8253"/>
<polygon fill="#000000" stroke="#000000" points="834.3683,-629.3254 824.3683,-632.8253 834.3682,-636.3254 834.3683,-629.3254"/>
</g>
<!-- sourcefile~temporal.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~temporal.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/temporal.f90.html" xlink:title="temporal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="352,-466.8253 279,-466.8253 279,-442.8253 352,-442.8253 352,-466.8253"/>
<text text-anchor="middle" x="315.5" y="-452.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">temporal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~temporal.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~temporal.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M884.4419,-644.8621C870.4507,-668.8576 835.0325,-721.1786 787.5,-730.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M787.5,-730.8253C750.3842,-738.358 765.4327,-688.8399 751,-653.8253 732.6796,-609.379 748.4975,-586.3077 715,-551.8253 620.4506,-454.496 445.9992,-448.2317 362.4712,-451.4534"/>
<polygon fill="#000000" stroke="#000000" points="362.0987,-447.9665 352.2661,-451.9125 362.4134,-454.9595 362.0987,-447.9665"/>
</g>
<!-- sourcefile~precipbcs_mod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~precipbcs_mod.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/precipbcs_mod.f90.html" xlink:title="precipBCs_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="518,-866.8253 412,-866.8253 412,-842.8253 518,-842.8253 518,-866.8253"/>
<text text-anchor="middle" x="465" y="-852.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precipBCs_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~precipbcs_mod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~precipbcs_mod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-894.8253C616.9528,-903.9172 551.4233,-884.9197 507.4696,-870.1067"/>
<polygon fill="#000000" stroke="#000000" points="508.489,-866.7564 497.8945,-866.8315 506.2235,-873.3796 508.489,-866.7564"/>
</g>
<!-- sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~timeutils.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/timeutils.f90.html" xlink:title="timeutils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350.5,-976.8253 280.5,-976.8253 280.5,-952.8253 350.5,-952.8253 350.5,-976.8253"/>
<text text-anchor="middle" x="315.5" y="-962.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">timeutils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~timeutils.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-894.8253C567.8327,-922.4887 532.9791,-856.127 465,-894.8253"/>
</g>
<!-- sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~phys_consts.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/phys_consts.f90.html" xlink:title="phys_consts.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="94,-506.8253 0,-506.8253 0,-482.8253 94,-482.8253 94,-506.8253"/>
<text text-anchor="middle" x="47" y="-492.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">phys_consts.F90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-894.8253C505.3155,-946.1254 502.5793,-1026.3336 363,-1065.8253 322.3726,-1077.3202 308.264,-1078.5345 268,-1065.8253 222.966,-1051.6105 219.4396,-1032.2574 181,-1004.8253"/>
</g>
<!-- sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~grid.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/grid.f90.html" xlink:title="grid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="342.5,-702.8253 288.5,-702.8253 288.5,-678.8253 342.5,-678.8253 342.5,-702.8253"/>
<text text-anchor="middle" x="315.5" y="-688.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M787.5,-730.8253C646.8018,-758.1831 608.0166,-740.3492 465,-730.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-730.8253C425.6007,-726.9636 382.0299,-714.2963 352.1412,-704.2391"/>
<polygon fill="#000000" stroke="#000000" points="353.1501,-700.8849 342.5554,-700.9449 350.8751,-707.5049 353.1501,-700.8849"/>
</g>
<!-- sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~mpimod.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/mpimod.f90.html" xlink:title="mpimod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="217.5,-664.8253 144.5,-664.8253 144.5,-640.8253 217.5,-640.8253 217.5,-664.8253"/>
<text text-anchor="middle" x="181" y="-650.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpimod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-730.8253C377.4577,-722.2448 350.7479,-741.6593 268,-711.8253 243.2927,-702.9174 218.8701,-685.3792 202.2202,-671.7292"/>
<polygon fill="#000000" stroke="#000000" points="204.1609,-668.7872 194.2616,-665.0118 199.6459,-674.1365 204.1609,-668.7872"/>
</g>
<!-- sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~mesh.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/mesh.f90.html" xlink:title="mesh.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="209.5,-428.8253 152.5,-428.8253 152.5,-404.8253 209.5,-404.8253 209.5,-428.8253"/>
<text text-anchor="middle" x="181" y="-414.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mesh.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M886.8824,-620.8066C870.5545,-574.2836 806.7539,-402.8624 715,-286.8253 597.747,-138.5409 456.1183,-14.4805 315.5,-140.8253"/>
</g>
<!-- sourcefile~io.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~io.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/io.f90.html" xlink:title="io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="492,-946.8253 438,-946.8253 438,-922.8253 492,-922.8253 492,-946.8253"/>
<text text-anchor="middle" x="465" y="-932.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~io.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-894.8253C594.7162,-912.3245 538.5648,-923.455 502.3301,-929.4154"/>
<polygon fill="#000000" stroke="#000000" points="501.5339,-925.9981 492.2105,-931.0306 502.6372,-932.9106 501.5339,-925.9981"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~potentialbcs_mumps.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/potentialbcs_mumps.f90.html" xlink:title="potentialBCs_mumps.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="531,-782.8253 399,-782.8253 399,-758.8253 531,-758.8253 531,-782.8253"/>
<text text-anchor="middle" x="465" y="-768.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">potentialBCs_mumps.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~potentialbcs_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~potentialbcs_mumps.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M787.5,-730.8253C718.7177,-744.1996 768.4439,-825.5084 715,-870.8253 688.6288,-893.1864 673.341,-882.5977 641,-894.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-894.8253C578.3525,-918.5113 588.7769,-825.701 531,-791.8253 527.9513,-790.0379 524.7328,-788.384 521.4235,-786.8567"/>
<polygon fill="#000000" stroke="#000000" points="522.4989,-783.5126 511.9228,-782.8814 519.7969,-789.9701 522.4989,-783.5126"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~potential_comm_mumps.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/potential_comm_mumps.f90.html" xlink:title="potential_comm_mumps.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="715,-584.8253 567,-584.8253 567,-560.8253 715,-560.8253 715,-584.8253"/>
<text text-anchor="middle" x="641" y="-570.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">potential_comm_mumps.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~potential_comm_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~potential_comm_mumps.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M787.5,-730.8253C733.9657,-741.2347 752.7648,-671.1711 715,-631.8253 700.4481,-616.6642 681.9659,-601.9256 667.1127,-590.9715"/>
<polygon fill="#000000" stroke="#000000" points="668.9964,-588.0143 658.844,-584.9847 664.8912,-593.6842 668.9964,-588.0143"/>
</g>
<!-- sourcefile~neutral.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~neutral.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/neutral.f90.html" xlink:title="neutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="497,-824.8253 433,-824.8253 433,-800.8253 497,-800.8253 497,-824.8253"/>
<text text-anchor="middle" x="465" y="-810.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">neutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gemini.f90&#45;&gt;sourcefile~neutral.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~gemini.f90&#45;&gt;sourcefile~neutral.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-894.8253C588.7097,-914.5955 582.3322,-855.9646 531,-833.8253 523.3074,-830.5076 514.9134,-827.4402 506.7696,-824.7328"/>
<polygon fill="#000000" stroke="#000000" points="507.6149,-821.3286 497.024,-821.6161 505.4827,-827.9959 507.6149,-821.3286"/>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~precipbcs_mod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~precipbcs_mod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-692.8253C568.107,-724.5088 596.2298,-788.4127 531,-833.8253 528.6408,-835.4678 526.1467,-836.9866 523.5635,-838.3905"/>
<polygon fill="#000000" stroke="#000000" points="522.0076,-835.2549 514.5034,-842.7342 525.0338,-841.567 522.0076,-835.2549"/>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~timeutils.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.8882,-645.0671C761.7291,-659.9029 736.9656,-685.5565 715,-706.8253 635.2298,-784.0652 627.8195,-821.463 531,-875.8253 504.3839,-890.7698 492.3143,-881.1988 465,-894.8253"/>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M786.5596,-620.5815C781.9613,-570.247 757.0789,-378.2794 641,-300.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-300.8253C576.9064,-258.0586 594.4804,-210.4971 531,-166.8253 505.526,-149.3004 493.7979,-156.0828 465,-144.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-144.8253C383.114,-112.8151 348.5623,-91.6162 268,-126.8253 215.8387,-149.6221 228.1165,-188.8796 181,-220.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M181,-220.8253C90.9437,-280.436 59.3299,-418.9719 50.1973,-472.8427"/>
<polygon fill="#000000" stroke="#000000" points="46.7412,-472.2905 48.6181,-482.7177 53.6534,-473.3959 46.7412,-472.2905"/>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M769.3981,-644.846C755.1242,-653.877 734.448,-665.9898 715,-673.8253 683.5045,-686.5148 672.1412,-679.2896 641,-692.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-692.8253C569.2615,-724.007 542.4522,-681.8768 465,-692.8253"/>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M750.6298,-630.3191C690.6042,-626.7752 568.0929,-621.7795 465,-631.8253"/>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-300.8253C608.9439,-279.8283 350.1158,-431.2636 315.5,-414.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-414.8253C285.63,-400.7296 247.7123,-402.8191 219.756,-407.5126"/>
<polygon fill="#000000" stroke="#000000" points="218.7567,-404.1385 209.5667,-409.4106 220.0386,-411.0201 218.7567,-404.1385"/>
</g>
<!-- sourcefile~ionization.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~ionization.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/ionization.f90.html" xlink:title="ionization.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="679,-664.8253 603,-664.8253 603,-640.8253 679,-640.8253 679,-664.8253"/>
<text text-anchor="middle" x="641" y="-650.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ionization.f90</text>
</a>
</g>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~ionization.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~ionization.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M750.9098,-637.8206C732.2044,-640.3742 709.2017,-643.5145 689.0827,-646.2611"/>
<polygon fill="#000000" stroke="#000000" points="688.6015,-642.7943 679.1669,-647.6148 689.5485,-649.7299 688.6015,-642.7943"/>
</g>
<!-- sourcefile~advec_mpi.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~advec_mpi.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/advec_mpi.f90.html" xlink:title="advec_mpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="506,-428.8253 424,-428.8253 424,-404.8253 506,-404.8253 506,-428.8253"/>
<text text-anchor="middle" x="465" y="-414.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_mpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~advec_mpi.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~advec_mpi.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-300.8253C588.1589,-266.214 585.4853,-358.8648 531,-390.8253 524.7193,-394.5095 517.8193,-397.8788 510.921,-400.8821"/>
<polygon fill="#000000" stroke="#000000" points="509.4781,-397.6912 501.5736,-404.7459 512.1522,-404.1603 509.4781,-397.6912"/>
</g>
<!-- sourcefile~collisions.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~collisions.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/collisions.f90.html" xlink:title="collisions.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="352,-192.8253 279,-192.8253 279,-168.8253 352,-168.8253 352,-192.8253"/>
<text text-anchor="middle" x="315.5" y="-178.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">collisions.f90</text>
</a>
</g>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~collisions.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-144.8253C424.4398,-128.9699 374.8682,-147.938 344.2382,-163.7879"/>
<polygon fill="#000000" stroke="#000000" points="342.5151,-160.7405 335.3714,-168.5647 345.8352,-166.9032 342.5151,-160.7405"/>
</g>
<!-- sourcefile~calculus.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~calculus.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/calculus.f90.html" xlink:title="calculus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-310.8253 281,-310.8253 281,-286.8253 350,-286.8253 350,-310.8253"/>
<text text-anchor="middle" x="315.5" y="-296.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~calculus.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~calculus.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-300.8253C575.5652,-257.965 538.8576,-326.5891 465,-300.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-300.8253C431.3468,-289.0861 390.7847,-289.3646 360.407,-292.1462"/>
<polygon fill="#000000" stroke="#000000" points="359.698,-288.7011 350.1147,-293.2189 360.4237,-295.6634 359.698,-288.7011"/>
</g>
<!-- sourcefile~sources.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~sources.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/sources.f90.html" xlink:title="sources.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="499,-272.8253 431,-272.8253 431,-248.8253 499,-248.8253 499,-272.8253"/>
<text text-anchor="middle" x="465" y="-258.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sources.f90</text>
</a>
</g>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~sources.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~sources.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641,-300.8253C601.3468,-274.8521 547.0996,-265.6077 509.3531,-262.3907"/>
<polygon fill="#000000" stroke="#000000" points="509.4018,-258.8848 499.17,-261.6343 508.8832,-265.8656 509.4018,-258.8848"/>
</g>
<!-- sourcefile~diffusion.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~diffusion.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/diffusion.f90.html" xlink:title="diffusion.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="500,-78.8253 430,-78.8253 430,-54.8253 500,-54.8253 500,-78.8253"/>
<text text-anchor="middle" x="465" y="-64.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diffusion.f90</text>
</a>
</g>
</g>
<!-- sourcefile~multifluid.f90&#45;&gt;sourcefile~diffusion.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~multifluid.f90&#45;&gt;sourcefile~diffusion.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M786.0077,-620.7417C779.1633,-566.5774 749.6219,-346.2084 715,-286.8253 659.6696,-191.9233 548.7518,-116.702 495.2433,-84.227"/>
<polygon fill="#000000" stroke="#000000" points="496.9326,-81.1591 486.555,-79.0245 493.3364,-87.1647 496.9326,-81.1591"/>
</g>
<!-- sourcefile~temporal.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~temporal.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M287.8266,-466.8794C261.0888,-477.5994 219.1433,-492.0049 181,-494.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M181,-494.8253C155.9398,-496.6784 128.1712,-496.9677 104.4411,-496.6829"/>
<polygon fill="#000000" stroke="#000000" points="104.2472,-493.1796 94.1935,-496.522 104.1373,-500.1787 104.2472,-493.1796"/>
</g>
<!-- sourcefile~temporal.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~temporal.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M303.4525,-466.965C292.8284,-478.2596 277.5865,-495.9869 268,-513.8253 243.0484,-560.2547 266.1123,-586.643 232,-626.8253 229.3619,-629.9329 226.26,-632.712 222.9106,-635.1883"/>
<polygon fill="#000000" stroke="#000000" points="220.7548,-632.4116 214.1984,-640.7342 224.5138,-638.3167 220.7548,-632.4116"/>
</g>
<!-- sourcefile~temporal.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~temporal.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.7473,-444.4417C260.2869,-439.2261 237.9367,-432.9115 219.2699,-427.6377"/>
<polygon fill="#000000" stroke="#000000" points="220.1812,-424.2582 209.6063,-424.9074 218.278,-430.9945 220.1812,-424.2582"/>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~timeutils.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M422.6223,-866.8597C414.2363,-870.4773 405.9033,-875.0661 399,-880.8253 375.7031,-900.2611 385.0317,-917.9664 363,-938.8253 359.6847,-941.9641 355.918,-944.8477 351.9903,-947.4599"/>
<polygon fill="#000000" stroke="#000000" points="349.9991,-944.5736 343.2478,-952.7388 353.6175,-950.5659 349.9991,-944.5736"/>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M431.7365,-866.9446C421.1471,-871.0635 409.468,-875.8821 399,-880.8253 382.4493,-888.6411 379.1713,-892.2521 363,-900.8253 342.1023,-911.9042 335.7667,-912.6304 315.5,-924.8253"/>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M412.3217,-842.6966C407.5049,-840.2608 402.9579,-837.3363 399,-833.8253 370.1355,-808.2201 382.6068,-788.0573 363,-754.8253 353.9473,-739.4817 341.9858,-723.3836 332.3311,-711.1708"/>
<polygon fill="#000000" stroke="#000000" points="334.7784,-708.6291 325.7832,-703.0311 329.3241,-713.0167 334.7784,-708.6291"/>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.8157,-862.3957C382.1569,-864.2905 345.3035,-862.6633 315.5,-848.8253"/>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.9297,-844.5024C407.0001,-841.7301 402.5371,-838.233 399,-833.8253 343.142,-764.2185 416.3003,-505.4096 363,-433.8253 349.4209,-415.5881 336.036,-424.5855 315.5,-414.8253"/>
</g>
<!-- sourcefile~interpolation.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~interpolation.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/interpolation.f90.html" xlink:title="interpolation.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-820.8253 271,-820.8253 271,-796.8253 360,-796.8253 360,-820.8253"/>
<text text-anchor="middle" x="315.5" y="-806.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interpolation.f90</text>
</a>
</g>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~interpolation.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~interpolation.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.7206,-842.7394C406.9225,-836.9553 384.2282,-829.9725 364.3304,-823.8501"/>
<polygon fill="#000000" stroke="#000000" points="365.1041,-820.4263 354.517,-820.8306 363.0455,-827.1167 365.1041,-820.4263"/>
</g>
<!-- sourcefile~reader.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~reader.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/reader.f90.html" xlink:title="reader.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="212,-820.8253 150,-820.8253 150,-796.8253 212,-796.8253 212,-820.8253"/>
<text text-anchor="middle" x="181" y="-806.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">reader.f90</text>
</a>
</g>
</g>
<!-- sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~reader.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~precipbcs_mod.f90&#45;&gt;sourcefile~reader.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M434.6909,-866.9044C404.7176,-877.516 357.3908,-890.7079 315.5,-886.8253"/>
</g>
<!-- sourcefile~timeutils.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~timeutils.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M291.1324,-976.9422C257.4343,-992.8881 198.7476,-1017.4908 181,-1004.8253"/>
</g>
<!-- sourcefile~grid.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~grid.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M306.7381,-702.9167C285.3639,-730.8755 228.7956,-795.6245 181,-768.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M181,-768.8253C86.5833,-715.8856 57.5113,-572.7863 49.6289,-517.2678"/>
<polygon fill="#000000" stroke="#000000" points="53.0652,-516.5546 48.287,-507.0984 46.1253,-517.4703 53.0652,-516.5546"/>
</g>
<!-- sourcefile~grid.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~grid.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M288.2819,-683.1355C270.8009,-678.1966 247.646,-671.6547 227.3231,-665.9129"/>
<polygon fill="#000000" stroke="#000000" points="228.186,-662.5198 217.6111,-663.169 226.2828,-669.2561 228.186,-662.5198"/>
</g>
<!-- sourcefile~grid.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~grid.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M304.0417,-678.5649C293.2251,-666.3475 277.3144,-646.6043 268,-626.8253 239.5263,-566.362 261.5079,-540.7908 232,-480.8253 223.9472,-464.4605 211.1459,-448.4145 200.3836,-436.4829"/>
<polygon fill="#000000" stroke="#000000" points="202.7201,-433.8562 193.342,-428.9265 197.5989,-438.6285 202.7201,-433.8562"/>
</g>
<!-- sourcefile~grid.f90&#45;&gt;sourcefile~reader.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~grid.f90&#45;&gt;sourcefile~reader.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M306.8831,-702.8444C292.8731,-721.7407 263.5323,-758.7234 232,-782.8253 227.6572,-786.1448 222.8264,-789.238 217.9178,-792.049"/>
<polygon fill="#000000" stroke="#000000" points="216.2405,-788.9769 209.0867,-796.7918 219.5526,-795.1438 216.2405,-788.9769"/>
</g>
<!-- sourcefile~mpimod.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~mpimod.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M150.6828,-640.7389C143.41,-636.9667 136.0156,-632.3233 130,-626.8253 94.9406,-594.7829 68.9511,-544.6584 56.0673,-516.2885"/>
<polygon fill="#000000" stroke="#000000" points="59.161,-514.6298 51.9211,-506.8945 52.757,-517.4563 59.161,-514.6298"/>
</g>
<!-- sourcefile~mesh.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~mesh.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M160.3562,-428.8419C137.9947,-441.8583 102.1206,-462.7402 76.7256,-477.5224"/>
<polygon fill="#000000" stroke="#000000" points="74.7698,-474.611 67.8881,-482.6666 78.2913,-480.6607 74.7698,-474.611"/>
</g>
<!-- sourcefile~io.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~io.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-1004.8253C257.4381,-990.6056 229.658,-1039.5497 181,-1004.8253"/>
</g>
<!-- sourcefile~io.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~io.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M446.4768,-922.6549C431.6119,-911.9776 411.2661,-895.1634 399,-875.8253 368.9468,-828.4454 388.1013,-805.0048 363,-754.8253 355.0531,-738.9389 343.1317,-722.8915 333.2203,-710.8396"/>
<polygon fill="#000000" stroke="#000000" points="335.8807,-708.5651 326.7533,-703.1853 330.5336,-713.0828 335.8807,-708.5651"/>
</g>
<!-- sourcefile~io.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~io.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M437.7129,-943.9563C425.5689,-948.4271 411.2715,-954.2621 399,-960.8253 362.01,-980.609 356.2441,-1014.8038 315.5,-1004.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-1004.8253C293.4153,-999.4167 282.1631,-1003.6128 268,-985.8253 203.2769,-904.5396 263.6107,-853.8062 232,-754.8253 222.5365,-725.1929 205.4788,-693.5127 193.7133,-673.4602"/>
<polygon fill="#000000" stroke="#000000" points="196.7084,-671.6491 188.5727,-664.8622 190.7003,-675.2412 196.7084,-671.6491"/>
</g>
<!-- sourcefile~pathlib.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~pathlib.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/pathlib.f90.html" xlink:title="pathlib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="346.5,-1056.8253 284.5,-1056.8253 284.5,-1032.8253 346.5,-1032.8253 346.5,-1056.8253"/>
<text text-anchor="middle" x="315.5" y="-1042.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pathlib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~io.f90&#45;&gt;sourcefile~pathlib.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~io.f90&#45;&gt;sourcefile~pathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M437.8685,-941.2301C425.0532,-945.2646 410.1588,-951.516 399,-960.8253 375.7031,-980.2611 385.0317,-997.9664 363,-1018.8253 359.6847,-1021.9641 355.918,-1024.8477 351.9903,-1027.4599"/>
<polygon fill="#000000" stroke="#000000" points="349.9991,-1024.5736 343.2478,-1032.7388 353.6175,-1030.5659 349.9991,-1024.5736"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~timeutils.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M410.3434,-782.9415C406.1525,-785.382 402.2836,-788.3109 399,-791.8253 353.0786,-840.9748 403.9784,-885.4848 363,-938.8253 360.6876,-941.8353 357.9231,-944.5426 354.9066,-946.9678"/>
<polygon fill="#000000" stroke="#000000" points="352.7453,-944.2057 346.4707,-952.7426 356.6995,-949.9819 352.7453,-944.2057"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-768.8253C256.0195,-762.871 233.1408,-798.0609 181,-768.8253"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430.5127,-758.729C420.189,-754.7133 408.968,-749.9474 399,-744.8253 378.5295,-734.3066 356.7354,-720.0994 340.5474,-708.8976"/>
<polygon fill="#000000" stroke="#000000" points="342.3719,-705.9023 332.1749,-703.0262 338.3527,-711.6335 342.3719,-705.9023"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.9962,-772.3927C372.9286,-772.3723 342.7486,-771.5531 315.5,-768.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-768.8253C258.8111,-763.1504 213.8905,-705.244 193.2797,-673.4557"/>
<polygon fill="#000000" stroke="#000000" points="196.1788,-671.4908 187.8988,-664.8808 190.2496,-675.2116 196.1788,-671.4908"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M416.0966,-758.7426C409.5214,-755.2241 403.5035,-750.6836 399,-744.8253 314.196,-634.5091 447.5149,-544.3632 363,-433.8253 349.1896,-415.7626 336.036,-424.5855 315.5,-414.8253"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~interpolation.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~interpolation.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M417.6973,-782.8488C402.61,-786.6837 385.7904,-790.9589 370.2221,-794.916"/>
<polygon fill="#000000" stroke="#000000" points="369.0326,-791.607 360.203,-797.4627 370.7571,-798.3913 369.0326,-791.607"/>
</g>
<!-- sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~reader.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~potentialbcs_mumps.f90&#45;&gt;sourcefile~reader.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-768.8253C279.0146,-765.1729 238.9376,-779.6429 212.1049,-792.1876"/>
<polygon fill="#000000" stroke="#000000" points="210.3141,-789.1664 202.8495,-796.6852 213.3736,-795.4624 210.3141,-789.1664"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-494.8253C342.7979,-463.2234 306.8786,-485.5175 181,-494.8253"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M625.0623,-584.8996C585.3375,-614.8183 483.7667,-690.1725 465,-692.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-692.8253C427.0649,-698.1878 383.1772,-696.7019 352.811,-694.4821"/>
<polygon fill="#000000" stroke="#000000" points="352.9117,-690.9791 342.6659,-693.6763 352.3574,-697.9571 352.9117,-690.9791"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M606.3973,-584.8311C557.2243,-601.833 472.2415,-630.9744 465,-631.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-631.8253C381.7946,-641.603 284.3073,-647.6375 227.9014,-650.6003"/>
<polygon fill="#000000" stroke="#000000" points="227.6665,-647.1076 217.8599,-651.1179 228.0269,-654.0983 227.6665,-647.1076"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M619.8803,-560.7113C587.6499,-542.8723 523.7286,-510.0128 465,-494.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-494.8253C413.8607,-481.6005 410.337,-457.2632 363,-433.8253 342.6235,-423.7364 336.036,-424.5855 315.5,-414.8253"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~potentialbcs_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~potentialbcs_mumps.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M619.6282,-584.9862C603.0653,-595.4315 580.6989,-611.9326 567,-631.8253 537.105,-675.2369 567.0047,-706.3294 531,-744.8253 527.8388,-748.2053 524.1835,-751.1532 520.2474,-753.723"/>
<polygon fill="#000000" stroke="#000000" points="518.271,-750.8187 511.2645,-758.766 521.6977,-756.9226 518.271,-750.8187"/>
</g>
<!-- sourcefile~potential_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~potential_mumps.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/potential_mumps.f90.html" xlink:title="potential_mumps.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="521,-584.8253 409,-584.8253 409,-560.8253 521,-560.8253 521,-584.8253"/>
<text text-anchor="middle" x="465" y="-570.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">potential_mumps.f90</text>
</a>
</g>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~potential_mumps.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~potential_mumps.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M566.8703,-572.8253C555.0266,-572.8253 542.8392,-572.8253 531.1953,-572.8253"/>
<polygon fill="#000000" stroke="#000000" points="531.1251,-569.3254 521.125,-572.8253 531.125,-576.3254 531.1251,-569.3254"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~collisions.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M637.482,-560.4526C619.4785,-497.2217 538.2189,-212.899 531,-206.8253 484.2553,-167.4965 410.3007,-167.5503 362.3394,-172.8805"/>
<polygon fill="#000000" stroke="#000000" points="361.7204,-169.4302 352.2228,-174.1255 362.5755,-176.3778 361.7204,-169.4302"/>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~calculus.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~calculus.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M639.0873,-560.8219C632.1707,-521.2893 604.8513,-393.7694 531,-324.8253 508.1844,-303.5258 494.4709,-311.1057 465,-300.8253"/>
</g>
<!-- sourcefile~pdeelliptic.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~pdeelliptic.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/pdeelliptic.f90.html" xlink:title="PDEelliptic.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="356,-546.8253 275,-546.8253 275,-522.8253 356,-522.8253 356,-546.8253"/>
<text text-anchor="middle" x="315.5" y="-532.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PDEelliptic.f90</text>
</a>
</g>
</g>
<!-- sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~pdeelliptic.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~potential_comm_mumps.f90&#45;&gt;sourcefile~pdeelliptic.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-494.8253C423.2201,-484.0209 375.0167,-502.5199 344.8965,-517.8048"/>
<polygon fill="#000000" stroke="#000000" points="342.9946,-514.851 335.7838,-522.6133 346.2614,-521.0419 342.9946,-514.851"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~timeutils.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.9614,-816.8268C420.9941,-819.7813 408.1123,-824.9135 399,-833.8253 363.7302,-868.3191 394.7866,-901.0975 363,-938.8253 360.4162,-941.8921 357.3746,-944.6588 354.0996,-947.1401"/>
<polygon fill="#000000" stroke="#000000" points="352.0356,-944.3085 345.6056,-952.7291 355.8833,-950.1562 352.0356,-944.3085"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.6661,-817.8849C421.0743,-820.9694 408.5291,-825.9141 399,-833.8253 372.9912,-855.4184 387.2024,-877.2253 363,-900.8253 346.0655,-917.3383 335.7667,-912.6304 315.5,-924.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-924.8253C296.0177,-936.5483 287.9973,-933.0043 268,-943.8253 226.4667,-966.2999 219.4396,-1032.2574 181,-1004.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M181,-1004.8253C98.5572,-945.9907 58.5224,-607.8498 49.1774,-517.1881"/>
<polygon fill="#000000" stroke="#000000" points="52.6533,-516.7719 48.1674,-507.1736 45.6886,-517.4744 52.6533,-516.7719"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.7819,-806.5278C421.4604,-803.3251 409.0643,-798.6225 399,-791.8253 382.4844,-780.671 349.4672,-737.481 330.2693,-711.3271"/>
<polygon fill="#000000" stroke="#000000" points="333.0509,-709.2012 324.3323,-703.1814 327.394,-713.3243 333.0509,-709.2012"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.7523,-822.8341C392.0652,-835.1151 326.0936,-853.744 315.5,-848.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-848.8253C294.8772,-839.25 284.6073,-845.3554 268,-829.8253 240.9939,-804.571 248.2683,-788.0286 232,-754.8253 218.3005,-726.8648 202.1859,-694.7641 191.7936,-674.162"/>
<polygon fill="#000000" stroke="#000000" points="194.8193,-672.389 187.1872,-665.0404 188.5708,-675.5445 194.8193,-672.389"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.8734,-810.0736C420.4471,-807.3225 407.2564,-802.0044 399,-791.8253 298.2632,-667.6301 459.1725,-561.5876 363,-433.8253 349.3257,-415.6594 336.036,-424.5855 315.5,-414.8253"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~interpolation.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~interpolation.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.9285,-811.9672C414.7168,-811.48 391.4222,-810.8567 370.3895,-810.294"/>
<polygon fill="#000000" stroke="#000000" points="370.3682,-806.7922 360.2782,-810.0234 370.1809,-813.7897 370.3682,-806.7922"/>
</g>
<!-- sourcefile~neutral.f90&#45;&gt;sourcefile~reader.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~neutral.f90&#45;&gt;sourcefile~reader.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.8089,-820.4747C421.7322,-823.7734 409.4861,-828.1906 399,-833.8253 360.2805,-854.6316 359.2681,-890.8819 315.5,-886.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-886.8253C269.8599,-882.5953 225.5905,-849.6595 200.9535,-827.96"/>
<polygon fill="#000000" stroke="#000000" points="203.1362,-825.2145 193.3773,-821.0895 198.4338,-830.3999 203.1362,-825.2145"/>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~timeutils.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~timeutils.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M602.6743,-658.2655C589.6001,-661.9905 576.0202,-668.2635 567,-678.8253 509.1973,-746.5071 590.727,-809.8355 531,-875.8253 510.5165,-898.4567 492.3143,-881.1988 465,-894.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M465,-894.8253C437.6857,-908.4519 426.5697,-900.7232 399,-913.8253 381.4061,-922.1867 379.567,-928.5788 363,-938.8253 358.2028,-941.7924 353.045,-944.7969 347.9592,-947.6582"/>
<polygon fill="#000000" stroke="#000000" points="346.0405,-944.7194 338.9759,-952.6151 349.4224,-950.8483 346.0405,-944.7194"/>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M617.4093,-640.7539C600.3309,-630.6664 578.3335,-614.5946 567,-593.8253 529.1236,-524.4148 588.2141,-294.4054 531,-239.8253 502.8199,-212.9426 213.3801,-199.1844 181,-220.8253"/>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M602.8875,-663.4166C567.4669,-672.7975 513.0908,-686.0273 465,-692.8253"/>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M602.8959,-643.075C567.2509,-635.1887 512.5239,-626.2407 465,-631.8253"/>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M624.0908,-640.7794C608.5878,-629.4094 585.3255,-611.511 567,-593.8253 549.3093,-576.7524 551.449,-565.474 531,-551.8253 479.6802,-517.572 445.4239,-549.4681 399,-508.8253 371.1804,-484.4701 390.0061,-459.0797 363,-433.8253 346.3927,-418.2952 336.036,-424.5855 315.5,-414.8253"/>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~neutral.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~neutral.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M602.6204,-659.1395C589.8524,-662.9514 576.4859,-669.0558 567,-678.8253 530.2819,-716.6414 568.2779,-754.561 531,-791.8253 524.3801,-798.4428 515.6836,-802.9776 506.7854,-806.0843"/>
<polygon fill="#000000" stroke="#000000" points="505.7429,-802.7427 497.1396,-808.926 507.7211,-809.4573 505.7429,-802.7427"/>
</g>
<!-- sourcefile~fang.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~fang.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/fang.f90.html" xlink:title="fang.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="208,-348.8253 154,-348.8253 154,-324.8253 208,-324.8253 208,-348.8253"/>
<text text-anchor="middle" x="181" y="-334.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fang.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ionization.f90&#45;&gt;sourcefile~fang.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~ionization.f90&#45;&gt;sourcefile~fang.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M618.2223,-640.7015C601.341,-630.4871 579.2242,-614.2749 567,-593.8253 521.1079,-517.0535 594.6507,-458.6632 531,-395.8253 446.3274,-312.234 290.271,-321.1755 218.6828,-330.6186"/>
<polygon fill="#000000" stroke="#000000" points="217.7655,-327.2127 208.3468,-332.0644 218.7353,-334.1452 217.7655,-327.2127"/>
</g>
<!-- sourcefile~interpolation.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~interpolation.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M270.934,-797.8338C238.0775,-789.3101 196.5119,-777.5229 181,-768.8253"/>
</g>
<!-- sourcefile~reader.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~reader.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.8001,-797.9686C142.4574,-794.1572 135.2505,-789.1874 130,-782.8253 95.546,-741.0769 62.2737,-576.9684 51.0185,-516.9574"/>
<polygon fill="#000000" stroke="#000000" points="54.4401,-516.212 49.1778,-507.0164 47.5571,-517.4866 54.4401,-516.212"/>
</g>
<!-- sourcefile~potential_mumps.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~potential_mumps.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.0045,-584.8558C395.0643,-593.5361 352.9887,-605.0492 315.5,-612.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-612.8253C256.9681,-624.9664 239.3385,-625.8639 181,-612.8253"/>
</g>
<!-- sourcefile~potential_mumps.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~potential_mumps.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-612.8253C284.9361,-619.1651 251.2735,-629.1791 225.2708,-637.6011"/>
<polygon fill="#000000" stroke="#000000" points="224.1132,-634.2973 215.7024,-640.74 226.2952,-640.9485 224.1132,-634.2973"/>
</g>
<!-- sourcefile~potential_mumps.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~potential_mumps.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M418.7355,-560.766C411.4143,-557.2254 404.4681,-552.6717 399,-546.8253 362.9953,-508.3294 398.9038,-472.4154 363,-433.8253 347.5121,-417.1787 336.036,-424.5855 315.5,-414.8253"/>
</g>
<!-- sourcefile~potential_mumps.f90&#45;&gt;sourcefile~interpolation.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~potential_mumps.f90&#45;&gt;sourcefile~interpolation.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M459.6753,-584.8532C440.9098,-627.0847 378.1652,-766.9036 363,-782.8253 360.0823,-785.8886 356.7226,-788.6784 353.1665,-791.1961"/>
<polygon fill="#000000" stroke="#000000" points="351.2217,-788.2846 344.628,-796.5777 354.9541,-794.2065 351.2217,-788.2846"/>
</g>
<!-- sourcefile~potential_mumps.f90&#45;&gt;sourcefile~calculus.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~potential_mumps.f90&#45;&gt;sourcefile~calculus.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M448.722,-560.8071C433.862,-549.059 412.2527,-529.9044 399,-508.8253 372.0696,-465.9913 381.7102,-447.8352 363,-400.8253 351.6397,-372.2822 336.3112,-340.3147 326.1772,-319.902"/>
<polygon fill="#000000" stroke="#000000" points="329.265,-318.2514 321.6597,-310.875 323.0051,-321.3841 329.265,-318.2514"/>
</g>
<!-- sourcefile~potential_mumps.f90&#45;&gt;sourcefile~pdeelliptic.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~potential_mumps.f90&#45;&gt;sourcefile~pdeelliptic.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M417.6973,-560.8019C401.4037,-556.6604 383.0897,-552.0053 366.5133,-547.7919"/>
<polygon fill="#000000" stroke="#000000" points="367.0044,-544.3055 356.4504,-545.2341 365.2799,-551.0898 367.0044,-544.3055"/>
</g>
<!-- sourcefile~advec_mpi.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~advec_mpi.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M431.6675,-404.6742C369.134,-383.9847 231.3931,-348.519 130,-395.8253 95.7009,-411.828 70.5554,-449.7507 57.3993,-473.7415"/>
<polygon fill="#000000" stroke="#000000" points="54.2079,-472.2906 52.6516,-482.7705 60.4036,-475.5484 54.2079,-472.2906"/>
</g>
<!-- sourcefile~advec_mpi.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~advec_mpi.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M448.0394,-428.8324C432.9161,-440.4351 411.3197,-459.3716 399,-480.8253 365.7188,-538.7816 391.4737,-566.362 363,-626.8253 355.4321,-642.8958 343.5095,-658.9426 333.5029,-670.9483"/>
<polygon fill="#000000" stroke="#000000" points="330.8208,-668.6992 326.9583,-678.5649 336.1301,-673.2612 330.8208,-668.6992"/>
</g>
<!-- sourcefile~advec_mpi.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~advec_mpi.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M449.5933,-429.0135C435.1501,-441.0269 413.6445,-460.4913 399,-480.8253 377.3918,-510.8286 389.4371,-529.976 363,-555.8253 329.8622,-588.2265 307.6787,-574.8764 268,-598.8253 250.6462,-609.2996 249.106,-615.9512 232,-626.8253 226.9493,-630.036 221.4528,-633.1748 215.9997,-636.098"/>
<polygon fill="#000000" stroke="#000000" points="214.2176,-633.0794 206.9498,-640.7884 217.4387,-639.2943 214.2176,-633.0794"/>
</g>
<!-- sourcefile~advec_mpi.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~advec_mpi.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M423.9029,-425.1805C392.6416,-429.4877 349.3767,-430.9259 315.5,-414.8253"/>
</g>
<!-- sourcefile~collisions.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~collisions.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M278.7214,-185.6874C250.1598,-190.8307 210.5713,-201.0617 181,-220.8253"/>
</g>
<!-- sourcefile~calculus.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~calculus.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.6911,-286.568C284.8313,-282.284 275.9963,-277.4013 268,-272.8253 228.9023,-250.4512 218.4525,-195.7944 181,-220.8253"/>
</g>
<!-- sourcefile~calculus.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~calculus.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M301.6127,-311.009C278.1549,-331.5891 230.5211,-373.3794 202.6477,-397.8333"/>
<polygon fill="#000000" stroke="#000000" points="200.2221,-395.3052 195.0132,-404.5312 204.8386,-400.5672 200.2221,-395.3052"/>
</g>
<!-- sourcefile~sources.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~sources.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430.7615,-256.224C400.2012,-253.0932 354.3981,-250.8142 315.5,-258.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-258.8253C254.6592,-271.3557 232.6452,-186.3088 181,-220.8253"/>
</g>
<!-- sourcefile~sources.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~sources.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M457.5048,-272.9597C443.6377,-295.9962 414.0254,-348.0421 399,-395.8253 367.8315,-494.9463 403.1316,-530.9823 363,-626.8253 356.1393,-643.2102 344.2147,-659.2561 334.0302,-671.1827"/>
<polygon fill="#000000" stroke="#000000" points="331.3513,-668.9285 327.341,-678.735 336.5915,-673.5697 331.3513,-668.9285"/>
</g>
<!-- sourcefile~sources.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~sources.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-258.8253C293.23,-263.4119 284.4145,-262.0916 268,-277.8253 239.8526,-304.8053 252.9687,-324.9542 232,-357.8253 222.9766,-371.9707 210.7386,-386.2464 200.5126,-397.2118"/>
<polygon fill="#000000" stroke="#000000" points="197.8696,-394.9116 193.4968,-404.562 202.9332,-399.7449 197.8696,-394.9116"/>
</g>
<!-- sourcefile~sources.f90&#45;&gt;sourcefile~collisions.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~sources.f90&#45;&gt;sourcefile~collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M442.2942,-248.6751C416.902,-235.0873 375.6035,-212.9878 347.074,-197.7211"/>
<polygon fill="#000000" stroke="#000000" points="348.398,-194.4601 337.9297,-192.8278 345.0953,-200.632 348.398,-194.4601"/>
</g>
<!-- sourcefile~sources.f90&#45;&gt;sourcefile~calculus.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~sources.f90&#45;&gt;sourcefile~calculus.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M430.7017,-269.5433C409.6755,-274.8878 382.5386,-281.7854 359.8847,-287.5436"/>
<polygon fill="#000000" stroke="#000000" points="358.986,-284.1607 350.1564,-290.0163 360.7105,-290.9449 358.986,-284.1607"/>
</g>
<!-- sourcefile~diffusion.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~diffusion.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M444.0952,-54.6834C394.1785,-27.4516 265.8821,31.975 181,-22.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M181,-22.8253C161.0215,-36.4615 145.54,-23.289 130,-41.8253 73.9492,-108.6834 53.1448,-390.7575 48.2265,-472.5246"/>
<polygon fill="#000000" stroke="#000000" points="44.7219,-472.5035 47.6359,-482.6897 51.7101,-472.9095 44.7219,-472.5035"/>
</g>
<!-- sourcefile~diffusion.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~diffusion.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M446.252,-79.0458C430.6032,-90.4003 409.2592,-108.8407 399,-130.8253 305.5339,-331.1148 439.9229,-419.6186 363,-626.8253 356.8961,-643.2673 345.1923,-659.1169 334.9301,-670.9301"/>
<polygon fill="#000000" stroke="#000000" points="332.2633,-668.6607 328.1424,-678.4213 337.4507,-673.3609 332.2633,-668.6607"/>
</g>
<!-- sourcefile~diffusion.f90&#45;&gt;sourcefile~mesh.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~diffusion.f90&#45;&gt;sourcefile~mesh.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M429.7697,-78.0563C397.2696,-89.7567 349.1059,-110.6306 315.5,-140.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M315.5,-140.8253C298.5868,-156.0218 282.3866,-142.2181 268,-159.8253 211.407,-229.0874 270.6083,-277.1445 232,-357.8253 224.8516,-372.7635 212.8919,-386.8956 202.3502,-397.5818"/>
<polygon fill="#000000" stroke="#000000" points="199.7427,-395.2353 195.0138,-404.7163 204.623,-400.2537 199.7427,-395.2353"/>
</g>
<!-- sourcefile~pdeparabolic.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~pdeparabolic.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/pdeparabolic.f90.html" xlink:title="PDEparabolic.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-74.8253 268,-74.8253 268,-50.8253 363,-50.8253 363,-74.8253"/>
<text text-anchor="middle" x="315.5" y="-60.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PDEparabolic.f90</text>
</a>
</g>
</g>
<!-- sourcefile~diffusion.f90&#45;&gt;sourcefile~pdeparabolic.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~diffusion.f90&#45;&gt;sourcefile~pdeparabolic.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M429.9489,-65.8875C413.0498,-65.4354 392.3372,-64.8812 373.1997,-64.3691"/>
<polygon fill="#000000" stroke="#000000" points="373.1552,-60.8668 363.0652,-64.098 372.9679,-67.8643 373.1552,-60.8668"/>
</g>
<!-- sourcefile~pdeelliptic.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~pdeelliptic.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.6911,-547.0827C284.8313,-551.3667 275.9963,-556.2494 268,-560.8253 228.9023,-583.1995 224.9624,-622.6508 181,-612.8253"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M181,-612.8253C125.8943,-600.5094 81.3651,-545.9768 60.261,-515.5414"/>
<polygon fill="#000000" stroke="#000000" points="62.963,-513.2874 54.4777,-506.943 57.1546,-517.1941 62.963,-513.2874"/>
</g>
<!-- sourcefile~pdeelliptic.f90&#45;&gt;sourcefile~mpimod.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~pdeelliptic.f90&#45;&gt;sourcefile~mpimod.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M287.0475,-546.9712C280.278,-550.7423 273.447,-555.3703 268,-560.8253 244.3907,-584.4695 255.9539,-603.5303 232,-626.8253 228.7048,-630.0299 224.9356,-632.9252 220.9713,-635.5184"/>
<polygon fill="#000000" stroke="#000000" points="218.9527,-632.6444 212.0892,-640.7155 222.4879,-638.6861 218.9527,-632.6444"/>
</g>
<!-- sourcefile~mumps_real32.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~mumps_real32.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/mumps_real32.f90.html" xlink:title="mumps_real32.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="232,-546.8253 130,-546.8253 130,-522.8253 232,-522.8253 232,-546.8253"/>
<text text-anchor="middle" x="181" y="-532.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mumps_real32.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pdeelliptic.f90&#45;&gt;sourcefile~mumps_real32.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~pdeelliptic.f90&#45;&gt;sourcefile~mumps_real32.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M274.7806,-534.8253C264.4804,-534.8253 253.1913,-534.8253 242.1252,-534.8253"/>
<polygon fill="#000000" stroke="#000000" points="242.06,-531.3254 232.0599,-534.8253 242.0599,-538.3254 242.06,-531.3254"/>
</g>
<!-- sourcefile~pdeparabolic.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~pdeparabolic.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M291.0057,-50.8048C257.4509,-35.1322 199.2665,-11.0324 181,-22.8253"/>
</g>
<!-- sourcefile~gbsv.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~gbsv.f90</title>
<g id="a_sourcefile~~gemini.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/gbsv.f90.html" xlink:title="gbsv.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="208,-74.8253 154,-74.8253 154,-50.8253 208,-50.8253 208,-74.8253"/>
<text text-anchor="middle" x="181" y="-60.4253" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">gbsv.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pdeparabolic.f90&#45;&gt;sourcefile~gbsv.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~pdeparabolic.f90&#45;&gt;sourcefile~gbsv.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M267.7016,-62.8253C251.5055,-62.8253 233.6626,-62.8253 218.3953,-62.8253"/>
<polygon fill="#000000" stroke="#000000" points="218.289,-59.3254 208.289,-62.8253 218.2889,-66.3254 218.289,-59.3254"/>
</g>
<!-- sourcefile~fang.f90&#45;&gt;sourcefile~phys_consts.f90 -->
<g id="sourcefile~~gemini.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~fang.f90&#45;&gt;sourcefile~phys_consts.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.8632,-347.3117C145.6038,-351.3433 136.8959,-356.5229 130,-362.8253 94.9406,-394.8678 68.9511,-444.9923 56.0673,-473.3622"/>
<polygon fill="#000000" stroke="#000000" points="52.757,-472.1943 51.9211,-482.7562 59.161,-475.0209 52.757,-472.1943"/>
</g>
</g>
</svg>
</div><script>var pansourcefilegeminif90EfferentGraph = svgPanZoom('#sourcefilegeminif90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-1">Programs</a></h3></div>
  <div id="progs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/gemini3d.html">Gemini3D</a>
      
    </div>
  </div>
</div>

















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/gemini.f90.html#src">gemini.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">Program </span><span class="n">Gemini3D</span>
<a name="ln-2"></a><span class="c">!! MAIN PROGRAM FOR GEMINI3D</span>
<a name="ln-3"></a><span class="c">!! Need program statement for FORD</span>
<a name="ln-4"></a><span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">stderr</span><span class="o">=&gt;</span><span class="n">error_unit</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">phys_consts</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">lnchem</span><span class="p">,</span> <span class="n">lwave</span><span class="p">,</span> <span class="n">lsp</span><span class="p">,</span> <span class="n">wp</span><span class="p">,</span> <span class="n">debug</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">grid</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">grid_size</span><span class="p">,</span><span class="n">read_grid</span><span class="p">,</span><span class="n">clear_grid</span><span class="p">,</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">,</span><span class="n">lx2all</span><span class="p">,</span><span class="n">lx3all</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">mesh</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">curvmesh</span>
<a name="ln-8"></a><span class="k">use </span><span class="n">io</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">read_configfile</span><span class="p">,</span><span class="n">input_plasma</span><span class="p">,</span><span class="n">create_outdir</span><span class="p">,</span><span class="n">output_plasma</span><span class="p">,</span><span class="n">create_outdir_aur</span><span class="p">,</span><span class="n">output_aur</span>
<a name="ln-9"></a><span class="k">use </span><span class="n">mpimod</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mpisetup</span><span class="p">,</span> <span class="n">mpibreakdown</span><span class="p">,</span> <span class="n">mpi_manualgrid</span><span class="p">,</span> <span class="n">mpigrid</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">myid</span>
<a name="ln-10"></a><span class="k">use </span><span class="n">multifluid</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">fluid_adv</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">neutral</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">neutral_atmos</span><span class="p">,</span><span class="n">make_dneu</span><span class="p">,</span><span class="n">neutral_perturb</span><span class="p">,</span><span class="n">clear_dneu</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">potentialBCs_mumps</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">clear_potential_fileinput</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">potential_comm</span><span class="p">,</span><span class="n">only</span> <span class="p">:</span> <span class="n">electrodynamics</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">precipBCs_mod</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">make_precip_fileinput</span><span class="p">,</span> <span class="n">clear_precip_fileinput</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">temporal</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dt_comm</span>
<a name="ln-16"></a><span class="k">use </span><span class="n">timeutils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dateinc</span>
<a name="ln-17"></a>
<a name="ln-18"></a><span class="k">implicit none</span>
<a name="ln-19"></a>
<a name="ln-20"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-21"></a>
<a name="ln-22"></a><span class="c">!&gt; VARIABLES READ IN FROM CONFIG.INI FILE</span>
<a name="ln-23"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ymd</span>
<a name="ln-24"></a><span class="c">!! year,month,day of simulation</span>
<a name="ln-25"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UTsec</span>
<a name="ln-26"></a><span class="c">!! UT (s)</span>
<a name="ln-27"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UTsec0</span>
<a name="ln-28"></a><span class="c">!! UT start time of simulation (s)</span>
<a name="ln-29"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tdur</span>
<a name="ln-30"></a><span class="c">!! duration of simulation</span>
<a name="ln-31"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">activ</span>
<a name="ln-32"></a><span class="c">!! f10.7a,f10.7,ap</span>
<a name="ln-33"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tcfl</span>
<a name="ln-34"></a><span class="c">!! target CFL number</span>
<a name="ln-35"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Teinf</span>
<a name="ln-36"></a><span class="c">!! exospheric temperature</span>
<a name="ln-37"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">potsolve</span>
<a name="ln-38"></a><span class="c">!! what type of potential solve</span>
<a name="ln-39"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagperiodic</span>
<a name="ln-40"></a><span class="c">!! toggles whether or not the grid is treated as periodic in the x3 dimension (affects some of the message passing)</span>
<a name="ln-41"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagoutput</span>
<a name="ln-42"></a><span class="c">!! what type of output to do (1 - everything; 2 - avg&#39;d parms.; 3 - ne only)</span>
<a name="ln-43"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagcap</span>
<a name="ln-44"></a><span class="c">!! internal capacitance?</span>
<a name="ln-45"></a>
<a name="ln-46"></a><span class="c">!&gt; INPUT AND OUTPUT FILES</span>
<a name="ln-47"></a><span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">infile</span>
<a name="ln-48"></a><span class="c">!! command line argument input file</span>
<a name="ln-49"></a><span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">outdir</span>
<a name="ln-50"></a><span class="c">!! &quot; &quot; output directory</span>
<a name="ln-51"></a><span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">indatsize</span><span class="p">,</span><span class="n">indatgrid</span>
<a name="ln-52"></a><span class="c">!! grid size and data filenames</span>
<a name="ln-53"></a>
<a name="ln-54"></a><span class="c">!&gt; GRID STRUCTURE</span>
<a name="ln-55"></a><span class="k">type</span><span class="p">(</span><span class="n">curvmesh</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-56"></a><span class="c">!! structure containg grid locations, finite differences, etc.:  see grid module for details</span>
<a name="ln-57"></a>
<a name="ln-58"></a><span class="c">!&gt; STATE VARIABLES</span>
<a name="ln-59"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ns</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">vs2</span><span class="p">,</span><span class="n">vs3</span><span class="p">,</span><span class="n">Ts</span>
<a name="ln-60"></a><span class="c">!! fluid state variables</span>
<a name="ln-61"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">E1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">E3</span><span class="p">,</span><span class="n">J1</span><span class="p">,</span><span class="n">J2</span><span class="p">,</span><span class="n">J3</span>
<a name="ln-62"></a><span class="c">!! electrodynamic state variables</span>
<a name="ln-63"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">rhov2</span><span class="p">,</span><span class="n">rhov3</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">B2</span><span class="p">,</span><span class="n">B3</span>
<a name="ln-64"></a><span class="c">!! inductive state vars. (for future use - except for B1 which is used for the background field)</span>
<a name="ln-65"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">rhom</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span>
<a name="ln-66"></a><span class="c">!! inductive auxiliary</span>
<a name="ln-67"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">nn</span>
<a name="ln-68"></a><span class="c">!! neutral density array</span>
<a name="ln-69"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">Tn</span><span class="p">,</span><span class="n">vn1</span><span class="p">,</span><span class="n">vn2</span><span class="p">,</span><span class="n">vn3</span>
<a name="ln-70"></a><span class="c">!! neutral temperature and velocities</span>
<a name="ln-71"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">Phiall</span>
<a name="ln-72"></a><span class="c">!! full-grid potential solution.  To store previous time step value</span>
<a name="ln-73"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">iver</span>
<a name="ln-74"></a><span class="c">!! integrated volume emission rate of aurora calculated by GLOW</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="c">!TEMPORAL VARIABLES</span>
<a name="ln-77"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span><span class="o">=</span><span class="mf">0._wp</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">1e-6_wp</span><span class="p">,</span><span class="n">dtprev</span>
<a name="ln-78"></a><span class="c">!! time from beginning of simulation (s) and time step (s)</span>
<a name="ln-79"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tout</span><span class="p">,</span><span class="n">dtout</span>
<a name="ln-80"></a><span class="c">!! time for next output and time between outputs</span>
<a name="ln-81"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tstart</span><span class="p">,</span><span class="n">tfin</span>
<a name="ln-82"></a><span class="c">!! temp. vars. for measuring performance of code blocks</span>
<a name="ln-83"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">it</span><span class="p">,</span><span class="n">isp</span>
<a name="ln-84"></a><span class="c">!! time and species loop indices</span>
<a name="ln-85"></a>
<a name="ln-86"></a><span class="c">!WORK ARRAYS</span>
<a name="ln-87"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dl1</span><span class="p">,</span><span class="n">dl2</span><span class="p">,</span><span class="n">dl3</span>     <span class="c">!these are grid distances in [m] used to compute Courant numbers</span>
<a name="ln-88"></a>
<a name="ln-89"></a><span class="c">!NEUTRAL PERTURBATION VARIABLES</span>
<a name="ln-90"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagdneu</span>
<a name="ln-91"></a><span class="c">!! toggles neutral perturbations (0 - none; 1 - file-based neutral inputs)</span>
<a name="ln-92"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">interptype</span>
<a name="ln-93"></a><span class="c">!! toggles whether the neutral input data are interpreted (0 - Cartesian; 1 - axisymmetric)</span>
<a name="ln-94"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dxn</span><span class="p">,</span><span class="n">drhon</span><span class="p">,</span><span class="n">dzn</span>
<a name="ln-95"></a><span class="c">!! finite differences for the neutral input data in the horizontal and vertical directions</span>
<a name="ln-96"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sourcemlat</span><span class="p">,</span><span class="n">sourcemlon</span>
<a name="ln-97"></a><span class="c">!! mag. lat./long for the neutral source location</span>
<a name="ln-98"></a><span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sourcedir</span>
<a name="ln-99"></a><span class="c">!! directory where neutral input data are located</span>
<a name="ln-100"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtneu</span>
<a name="ln-101"></a><span class="c">!! time interval [s] in between neutral inputs</span>
<a name="ln-102"></a>
<a name="ln-103"></a><span class="c">!&gt; PRECIPITATION FILE INPUT VARIABLES</span>
<a name="ln-104"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagprecfile</span>
<a name="ln-105"></a><span class="c">!! flag toggling precipitation file input (0 - no; 1 - yes)</span>
<a name="ln-106"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtprec</span>
<a name="ln-107"></a><span class="c">!! time interval between precip. inputs</span>
<a name="ln-108"></a><span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">precdir</span>
<a name="ln-109"></a><span class="c">!! directory containing precip. input files</span>
<a name="ln-110"></a>
<a name="ln-111"></a><span class="c">!&gt; ELECTRIC FIELD FILE INPUT VARIABLES</span>
<a name="ln-112"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagE0file</span>
<a name="ln-113"></a><span class="c">!! flag toggling electric field (potential BCs) file input (0 - no; 1 - yes)</span>
<a name="ln-114"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtE0</span>
<a name="ln-115"></a><span class="c">!! time interval between electric field file inputs</span>
<a name="ln-116"></a><span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">E0dir</span>
<a name="ln-117"></a><span class="c">!! directory containing electric field file input data</span>
<a name="ln-118"></a>
<a name="ln-119"></a><span class="c">!&gt; GLOW MODULE INPUT VARIABLES</span>
<a name="ln-120"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">flagglow</span>
<a name="ln-121"></a><span class="c">!! flag toggling GLOW module run (include aurora) (0 - no; 1 - yes)</span>
<a name="ln-122"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtglow</span>
<a name="ln-123"></a><span class="c">!! time interval between GLOW runs (s)</span>
<a name="ln-124"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dtglowout</span>
<a name="ln-125"></a><span class="c">!! time interval between GLOW auroral outputs (s)</span>
<a name="ln-126"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tglowout</span>
<a name="ln-127"></a><span class="c">!! time for next GLOW output</span>
<a name="ln-128"></a>
<a name="ln-129"></a><span class="c">!&gt; FOR HANDLING OUTPUT</span>
<a name="ln-130"></a><span class="kt">logical</span> <span class="kd">::</span> <span class="n">nooutput</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-131"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">argc</span>
<a name="ln-132"></a><span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">argv</span>
<a name="ln-133"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">lid2in</span><span class="p">,</span><span class="n">lid3in</span>
<a name="ln-134"></a>
<a name="ln-135"></a><span class="kt">character</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span>
<a name="ln-136"></a>
<a name="ln-137"></a><span class="c">!&gt; TO CONTROL THROTTLING OF TIME STEP</span>
<a name="ln-138"></a><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">dtscale</span><span class="o">=</span><span class="mi">2</span><span class="n">d0</span>
<a name="ln-139"></a>
<a name="ln-140"></a><span class="c">!! MAIN PROGRAM</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="n">argc</span> <span class="o">=</span> <span class="nb">command_argument_count</span><span class="p">()</span>
<a name="ln-143"></a><span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-144"></a><span class="k">  print</span> <span class="s1">&#39;(/,A,/)&#39;</span><span class="p">,</span> <span class="s1">&#39;GEMINI-3D: by Matthew Zettergren&#39;</span>
<a name="ln-145"></a>  <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="s1">&#39;GLOW and auroral interfaces by Guy Grubbs&#39;</span>
<a name="ln-146"></a>  <span class="k">print</span> <span class="s1">&#39;(A,/)&#39;</span><span class="p">,</span> <span class="s1">&#39;build system and software engineering by Michael Hirsch&#39;</span>
<a name="ln-147"></a>  <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;must specify .ini file to configure simulation and output directory. Example:&#39;</span>
<a name="ln-148"></a>  <span class="k">print</span> <span class="s1">&#39;(/,A,/)&#39;</span><span class="p">,</span> <span class="s1">&#39;mpiexec -np 4 build/gemini.bin initialize/test2d_fang/config.nml /tmp/test2d_fang&#39;</span>
<a name="ln-149"></a>  <span class="k">stop </span><span class="mi">77</span>
<a name="ln-150"></a>  <span class="c">!! stops with de facto &quot;skip test&quot; return code</span>
<a name="ln-151"></a><span class="n">endif</span>
<a name="ln-152"></a>
<a name="ln-153"></a><span class="c">!&gt; INITIALIZE MESSING PASSING VARIABLES, IDS ETC.</span>
<a name="ln-154"></a><span class="k">call </span><span class="n">mpisetup</span><span class="p">()</span>
<a name="ln-155"></a><span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">argv</span><span class="p">)</span>
<a name="ln-156"></a><span class="k">call </span><span class="nb">date_and_time</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="nb">time</span><span class="p">)</span>
<a name="ln-157"></a><span class="k">print</span> <span class="s1">&#39;(2A,I6,A3,I6,3A)&#39;</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">argv</span><span class="p">),</span> <span class="s1">&#39; Process:  &#39;</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span><span class="s1">&#39; / &#39;</span><span class="p">,</span><span class="n">lid</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; at &#39;</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="nb">time</span>
<a name="ln-158"></a>
<a name="ln-159"></a>
<a name="ln-160"></a><span class="c">!&gt; READ FILE INPUT</span>
<a name="ln-161"></a><span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-162"></a><span class="n">infile</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-163"></a>
<a name="ln-164"></a><span class="k">call </span><span class="n">read_configfile</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span><span class="n">UTsec0</span><span class="p">,</span><span class="n">tdur</span><span class="p">,</span><span class="n">dtout</span><span class="p">,</span><span class="n">activ</span><span class="p">,</span><span class="n">tcfl</span><span class="p">,</span><span class="n">Teinf</span><span class="p">,</span><span class="n">potsolve</span><span class="p">,</span><span class="n">flagperiodic</span><span class="p">,</span><span class="n">flagoutput</span><span class="p">,</span><span class="n">flagcap</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-165"></a>                     <span class="n">indatsize</span><span class="p">,</span><span class="n">indatgrid</span><span class="p">,</span><span class="n">flagdneu</span><span class="p">,</span><span class="n">interptype</span><span class="p">,</span><span class="n">sourcemlat</span><span class="p">,</span><span class="n">sourcemlon</span><span class="p">,</span><span class="n">dtneu</span><span class="p">,</span><span class="n">dxn</span><span class="p">,</span><span class="n">drhon</span><span class="p">,</span><span class="n">dzn</span><span class="p">,</span><span class="n">sourcedir</span><span class="p">,</span><span class="n">flagprecfile</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-166"></a>                     <span class="n">dtprec</span><span class="p">,</span><span class="n">precdir</span><span class="p">,</span><span class="n">flagE0file</span><span class="p">,</span><span class="n">dtE0</span><span class="p">,</span><span class="n">E0dir</span><span class="p">,</span><span class="n">flagglow</span><span class="p">,</span><span class="n">dtglow</span><span class="p">,</span><span class="n">dtglowout</span><span class="p">)</span>
<a name="ln-167"></a>
<a name="ln-168"></a><span class="c">!&gt; CHECK THE GRID SIZE AND ESTABLISH A PROCESS GRID</span>
<a name="ln-169"></a><span class="k">call </span><span class="n">grid_size</span><span class="p">(</span><span class="n">indatsize</span><span class="p">)</span>
<a name="ln-170"></a>
<a name="ln-171"></a><span class="k">select case</span> <span class="p">(</span><span class="n">argc</span><span class="p">)</span>
<a name="ln-172"></a>  <span class="k">case</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c">!&lt; user specified process grid</span>
<a name="ln-173"></a>    <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-174"></a>    <span class="k">read</span><span class="p">(</span><span class="n">argv</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">lid2in</span>
<a name="ln-175"></a>    <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-176"></a>    <span class="k">read</span><span class="p">(</span><span class="n">argv</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">lid3in</span>
<a name="ln-177"></a>    <span class="k">call </span><span class="n">mpi_manualgrid</span><span class="p">(</span><span class="n">lx2all</span><span class="p">,</span><span class="n">lx3all</span><span class="p">,</span><span class="n">lid2in</span><span class="p">,</span><span class="n">lid3in</span><span class="p">)</span>
<a name="ln-178"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-179"></a><span class="k">      call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-180"></a>      <span class="k">select case</span> <span class="p">(</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-181"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;-debug&#39;</span><span class="p">)</span>
<a name="ln-182"></a>          <span class="n">debug</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-183"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;-nooutput&#39;</span><span class="p">)</span>
<a name="ln-184"></a>          <span class="n">nooutput</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-185"></a>      <span class="k">end select</span>
<a name="ln-186"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-187"></a>  <span class="k">case </span><span class="n">default</span>
<a name="ln-188"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-189"></a><span class="k">      call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-190"></a>      <span class="k">select case</span> <span class="p">(</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-191"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;-debug&#39;</span><span class="p">)</span>
<a name="ln-192"></a>          <span class="n">debug</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-193"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;-nooutput&#39;</span><span class="p">)</span>
<a name="ln-194"></a>          <span class="n">nooutput</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-195"></a>      <span class="k">end select</span>
<a name="ln-196"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-197"></a>    <span class="k">call </span><span class="n">mpigrid</span><span class="p">(</span><span class="n">lx2all</span><span class="p">,</span><span class="n">lx3all</span><span class="p">)</span>
<a name="ln-198"></a>    <span class="c">!! following grid_size these are in scope</span>
<a name="ln-199"></a><span class="k">end select</span>
<a name="ln-200"></a>
<a name="ln-201"></a>
<a name="ln-202"></a><span class="c">!&gt; LOAD UP THE GRID STRUCTURE/MODULE VARS. FOR THIS SIMULATION</span>
<a name="ln-203"></a><span class="k">call </span><span class="n">read_grid</span><span class="p">(</span><span class="n">indatsize</span><span class="p">,</span><span class="n">indatgrid</span><span class="p">,</span><span class="n">flagperiodic</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-204"></a><span class="c">!! read in a previously generated grid from filenames listed in input file</span>
<a name="ln-205"></a>
<a name="ln-206"></a>
<a name="ln-207"></a><span class="c">!&gt; CREATE/PREP OUTPUT DIRECTORY AND OUTPUT SIMULATION SIZE AND GRID DATA</span>
<a name="ln-208"></a><span class="c">!&gt; ONLY THE ROOT PROCESS WRITES OUTPUT DATA</span>
<a name="ln-209"></a><span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-210"></a><span class="n">outdir</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
<a name="ln-211"></a>
<a name="ln-212"></a><span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-213"></a><span class="k">  call </span><span class="n">create_outdir</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">indatsize</span><span class="p">,</span><span class="n">indatgrid</span><span class="p">,</span><span class="n">flagdneu</span><span class="p">,</span><span class="n">sourcedir</span><span class="p">,</span><span class="n">flagprecfile</span><span class="p">,</span><span class="n">precdir</span><span class="p">,</span><span class="n">flagE0file</span><span class="p">,</span><span class="n">E0dir</span><span class="p">)</span>
<a name="ln-214"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">flagglow</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">create_outdir_aur</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span>
<a name="ln-215"></a><span class="k">end if</span>
<a name="ln-216"></a>
<a name="ln-217"></a>
<a name="ln-218"></a><span class="c">!&gt; ALLOCATE ARRAYS (AT THIS POINT ALL SIZES ARE SET FOR EACH PROCESS SUBGRID)</span>
<a name="ln-219"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ns</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">lsp</span><span class="p">),</span><span class="n">vs1</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">lsp</span><span class="p">),</span><span class="n">vs2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">lsp</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-220"></a>  <span class="n">vs3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">lsp</span><span class="p">),</span> <span class="n">Ts</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">lsp</span><span class="p">))</span>
<a name="ln-221"></a><span class="k">allocate</span><span class="p">(</span><span class="n">rhov2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">rhov3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">B1</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-222"></a>         <span class="n">B2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">B3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-223"></a><span class="k">allocate</span><span class="p">(</span><span class="n">v1</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">v2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-224"></a>         <span class="n">v3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">rhom</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-225"></a><span class="k">allocate</span><span class="p">(</span><span class="n">E1</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">E2</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">E3</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">J1</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">J2</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">J3</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">))</span>
<a name="ln-226"></a><span class="k">allocate</span><span class="p">(</span><span class="n">nn</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">,</span><span class="n">lnchem</span><span class="p">),</span><span class="n">Tn</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">vn1</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span> <span class="n">vn2</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">),</span><span class="n">vn3</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">))</span>
<a name="ln-227"></a><span class="k">call </span><span class="n">make_dneu</span><span class="p">()</span>
<a name="ln-228"></a><span class="c">!! allocate space for neutral perturbations in case they are used with this run</span>
<a name="ln-229"></a><span class="k">call </span><span class="n">make_precip_fileinput</span><span class="p">()</span>
<a name="ln-230"></a>
<a name="ln-231"></a>
<a name="ln-232"></a><span class="c">!&gt; ALLOCATE MEMORY FOR ROOT TO STORE CERTAIN VARS. OVER ENTIRE GRID</span>
<a name="ln-233"></a><span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-234"></a><span class="k">  allocate</span><span class="p">(</span><span class="n">Phiall</span><span class="p">(</span><span class="n">lx1</span><span class="p">,</span><span class="n">lx2all</span><span class="p">,</span><span class="n">lx3all</span><span class="p">))</span>
<a name="ln-235"></a><span class="k">end if</span>
<a name="ln-236"></a>
<a name="ln-237"></a><span class="c">!&gt; ALLOCATE MEMORY FOR AURORAL EMISSIONS, IF CALCULATED</span>
<a name="ln-238"></a><span class="k">if</span> <span class="p">(</span><span class="n">flagglow</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-239"></a><span class="k">  allocate</span><span class="p">(</span><span class="n">iver</span><span class="p">(</span><span class="n">lx2</span><span class="p">,</span><span class="n">lx3</span><span class="p">,</span><span class="n">lwave</span><span class="p">))</span>
<a name="ln-240"></a><span class="k">end if</span>
<a name="ln-241"></a>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="c">!&gt; LOAD ICS AND DISTRIBUTE TO WORKERS (REQUIRES GRAVITY FOR INITIAL GUESSING)</span>
<a name="ln-244"></a><span class="k">call </span><span class="n">input_plasma</span><span class="p">(</span><span class="n">x</span><span class="p">%</span><span class="n">x1</span><span class="p">,</span><span class="n">x</span><span class="p">%</span><span class="n">x2all</span><span class="p">,</span><span class="n">x</span><span class="p">%</span><span class="n">x3all</span><span class="p">,</span><span class="n">indatsize</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">Ts</span><span class="p">)</span>
<a name="ln-245"></a>
<a name="ln-246"></a><span class="c">!ROOT/WORKERS WILL ASSUME THAT THE MAGNETIC FIELDS AND PERP FLOWS START AT ZERO</span>
<a name="ln-247"></a><span class="c">!THIS KEEPS US FROM HAVING TO HAVE FULL-GRID ARRAYS FOR THESE STATE VARS (EXCEPT</span>
<a name="ln-248"></a><span class="c">!FOR IN OUTPUT FNS.).  IF A SIMULATIONS IS DONE WITH INTERTIAL CAPACITANCE THERE</span>
<a name="ln-249"></a><span class="c">!WILL BE A FINITE AMOUNT OF TIME FOR THE FLOWS TO &#39;START UP&#39;, BUT THIS SHOULDN&#39;T</span>
<a name="ln-250"></a><span class="c">!BE TOO MUCH OF AN ISSUE.  WE ALSO NEED TO SET THE BACKGROUND MAGNETIC FIELD STATE</span>
<a name="ln-251"></a><span class="c">!VARIABLE HERE TO WHATEVER IS SPECIFIED IN THE GRID STRUCTURE (THESE MUST BE CONSISTENT)</span>
<a name="ln-252"></a><span class="n">rhov2</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">rhov3</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">v2</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">v3</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span>
<a name="ln-253"></a><span class="n">B2</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">B3</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span>
<a name="ln-254"></a><span class="n">B1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lx1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">lx2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">lx3</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="p">%</span><span class="n">Bmag</span>
<a name="ln-255"></a><span class="c">!! this assumes that the grid is defined s.t. the x1 direction corresponds</span>
<a name="ln-256"></a><span class="c">!! to the magnetic field direction (hence zero B2 and B3).</span>
<a name="ln-257"></a>
<a name="ln-258"></a>
<a name="ln-259"></a><span class="c">!&gt; INITIALIZE ELECTRODYNAMIC QUANTITIES FOR POLARIZATION CURRENT</span>
<a name="ln-260"></a><span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">Phiall</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-261"></a><span class="c">!! only root stores entire potential array</span>
<a name="ln-262"></a><span class="n">E1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">E2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">E3</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<a name="ln-263"></a><span class="n">vs2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">vs3</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="c">!&gt; INITIALIZE AURORAL EMISSION MAP</span>
<a name="ln-266"></a><span class="k">if</span><span class="p">(</span><span class="n">flagglow</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="n">iver</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-267"></a>
<a name="ln-268"></a>
<a name="ln-269"></a><span class="c">!&gt; MAIN LOOP</span>
<a name="ln-270"></a><span class="n">UTsec</span><span class="o">=</span><span class="n">UTsec0</span><span class="p">;</span> <span class="n">it</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">tout</span><span class="o">=</span><span class="n">t</span><span class="p">;</span> <span class="n">tglowout</span><span class="o">=</span><span class="n">t</span><span class="p">;</span>
<a name="ln-271"></a><span class="k">do while</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;</span><span class="n">tdur</span><span class="p">)</span>
<a name="ln-272"></a>  <span class="c">!! TIME STEP CALCULATION</span>
<a name="ln-273"></a>  <span class="n">dtprev</span><span class="o">=</span><span class="n">dt</span>
<a name="ln-274"></a>  <span class="k">call </span><span class="n">dt_comm</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">tglowout</span><span class="p">,</span><span class="n">flagglow</span><span class="p">,</span><span class="n">tcfl</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">Ts</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">vs2</span><span class="p">,</span><span class="n">vs3</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">B2</span><span class="p">,</span><span class="n">B3</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">potsolve</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-275"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-276"></a><span class="k">    if</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="n">dtprev</span> <span class="o">&gt;</span> <span class="n">dtscale</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-277"></a>      <span class="c">!! throttle how quickly we allow dt to increase</span>
<a name="ln-278"></a>      <span class="n">dt</span><span class="o">=</span><span class="n">dtscale</span><span class="o">*</span><span class="n">dtprev</span>
<a name="ln-279"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-280"></a><span class="k">        print</span> <span class="s1">&#39;(A,EN14.3)&#39;</span><span class="p">,</span> <span class="s1">&#39;Throttling dt to:  &#39;</span><span class="p">,</span><span class="n">dt</span>
<a name="ln-281"></a>      <span class="k">end if</span>
<a name="ln-282"></a><span class="k">    end if</span>
<a name="ln-283"></a><span class="k">  end if</span>
<a name="ln-284"></a>
<a name="ln-285"></a>
<a name="ln-286"></a>  <span class="c">!COMPUTE BACKGROUND NEUTRAL ATMOSPHERE USING MSIS00.  PRESENTLY THIS ONLY GETS CALLED</span>
<a name="ln-287"></a>  <span class="c">!ON THE FIRST TIME STEP DUE TO A NEED TO KEEP A CONSTANT BACKGROUND (I.E. ONE NOT VARYING</span>
<a name="ln-288"></a>  <span class="c">!IN TIME) FOR SOME SIMULATIONS USING NEUTRAL INPUT.  REALISTICALLY THIS NEEDS TO BE</span>
<a name="ln-289"></a>  <span class="c">!RECALLED EVERY SO OFTEN (MAYBE EVERY 10-15 MINS)</span>
<a name="ln-290"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-291"></a><span class="k">    call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<a name="ln-292"></a>    <span class="k">call </span><span class="n">neutral_atmos</span><span class="p">(</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">,</span><span class="n">x</span><span class="p">%</span><span class="n">glat</span><span class="p">,</span><span class="n">x</span><span class="p">%</span><span class="n">glon</span><span class="p">,</span><span class="n">x</span><span class="p">%</span><span class="n">alt</span><span class="p">,</span><span class="n">activ</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">Tn</span><span class="p">)</span>
<a name="ln-293"></a>    <span class="n">vn1</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">vn2</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span><span class="p">;</span> <span class="n">vn3</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span>
<a name="ln-294"></a>    <span class="c">!! hard-code these to zero for the first time step</span>
<a name="ln-295"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-296"></a><span class="k">      call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tfin</span><span class="p">)</span>
<a name="ln-297"></a>      <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Neutral background calculated in time:  &#39;</span><span class="p">,</span><span class="n">tfin</span><span class="o">-</span><span class="n">tstart</span>
<a name="ln-298"></a>    <span class="k">end if</span>
<a name="ln-299"></a><span class="k">  end if</span>
<a name="ln-300"></a>
<a name="ln-301"></a>
<a name="ln-302"></a>  <span class="c">!&gt; GET NEUTRAL PERTURBATIONS FROM ANOTHER MODEL</span>
<a name="ln-303"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">flagdneu</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-304"></a><span class="k">    call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<a name="ln-305"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-306"></a>      <span class="c">!! this triggers the code to load the neutral frame correspdonding ot the beginning time of the simulation</span>
<a name="ln-307"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;!!!Attempting initial load of neutral dynamics files!!!&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-308"></a>                              <span class="s1">&#39; This is a workaround that fixes the restart code...&#39;</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="n">dt</span>
<a name="ln-309"></a>      <span class="k">call </span><span class="n">neutral_perturb</span><span class="p">(</span><span class="n">interptype</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dtneu</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="n">dtneu</span><span class="p">,</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="o">-</span><span class="n">dtneu</span><span class="p">,</span><span class="n">sourcedir</span><span class="p">,</span><span class="n">dxn</span><span class="p">,</span><span class="n">drhon</span><span class="p">,</span><span class="n">dzn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-310"></a>                                  <span class="n">sourcemlat</span><span class="p">,</span><span class="n">sourcemlon</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">Tn</span><span class="p">,</span><span class="n">vn1</span><span class="p">,</span><span class="n">vn2</span><span class="p">,</span><span class="n">vn3</span><span class="p">)</span>
<a name="ln-311"></a>    <span class="k">end if</span>
<a name="ln-312"></a><span class="k">    call </span><span class="n">neutral_perturb</span><span class="p">(</span><span class="n">interptype</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dtneu</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">,</span><span class="n">sourcedir</span><span class="p">,</span><span class="n">dxn</span><span class="p">,</span><span class="n">drhon</span><span class="p">,</span><span class="n">dzn</span><span class="p">,</span><span class="n">sourcemlat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-313"></a>                                  <span class="n">sourcemlon</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">Tn</span><span class="p">,</span><span class="n">vn1</span><span class="p">,</span><span class="n">vn2</span><span class="p">,</span><span class="n">vn3</span><span class="p">)</span>
<a name="ln-314"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-315"></a><span class="k">      call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tfin</span><span class="p">)</span>
<a name="ln-316"></a>      <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Neutral perturbations calculated in time:  &#39;</span><span class="p">,</span><span class="n">tfin</span><span class="o">-</span><span class="n">tstart</span>
<a name="ln-317"></a>    <span class="n">endif</span>
<a name="ln-318"></a>  <span class="k">end if</span>
<a name="ln-319"></a>
<a name="ln-320"></a>  <span class="c">!! POTENTIAL SOLUTION</span>
<a name="ln-321"></a>  <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<a name="ln-322"></a>  <span class="k">call </span><span class="n">electrodynamics</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">vn2</span><span class="p">,</span><span class="n">vn3</span><span class="p">,</span><span class="n">Tn</span><span class="p">,</span><span class="n">sourcemlat</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">Ts</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">vs2</span><span class="p">,</span><span class="n">vs3</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-323"></a>                        <span class="n">potsolve</span><span class="p">,</span><span class="n">flagcap</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">E3</span><span class="p">,</span><span class="n">J1</span><span class="p">,</span><span class="n">J2</span><span class="p">,</span><span class="n">J3</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-324"></a>                        <span class="n">Phiall</span><span class="p">,</span><span class="n">flagE0file</span><span class="p">,</span><span class="n">dtE0</span><span class="p">,</span><span class="n">E0dir</span><span class="p">,</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">)</span>
<a name="ln-325"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-326"></a><span class="k">    call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tfin</span><span class="p">)</span>
<a name="ln-327"></a>    <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Electrodynamics total solve time:  &#39;</span><span class="p">,</span><span class="n">tfin</span><span class="o">-</span><span class="n">tstart</span>
<a name="ln-328"></a>  <span class="n">endif</span>
<a name="ln-329"></a>
<a name="ln-330"></a>  <span class="c">!! UPDATE THE FLUID VARIABLES</span>
<a name="ln-331"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<a name="ln-332"></a>  <span class="k">call </span><span class="n">fluid_adv</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">Ts</span><span class="p">,</span><span class="n">vs2</span><span class="p">,</span><span class="n">vs3</span><span class="p">,</span><span class="n">J1</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">Teinf</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">vn1</span><span class="p">,</span><span class="n">vn2</span><span class="p">,</span><span class="n">vn3</span><span class="p">,</span><span class="n">Tn</span><span class="p">,</span><span class="n">iver</span><span class="p">,</span><span class="n">activ</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">activ</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-333"></a>                 <span class="n">flagprecfile</span><span class="p">,</span><span class="n">dtprec</span><span class="p">,</span><span class="n">precdir</span><span class="p">,</span><span class="n">flagglow</span><span class="p">,</span><span class="n">dtglow</span><span class="p">)</span>
<a name="ln-334"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-335"></a><span class="k">    call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tfin</span><span class="p">)</span>
<a name="ln-336"></a>    <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Multifluid total solve time:  &#39;</span><span class="p">,</span><span class="n">tfin</span><span class="o">-</span><span class="n">tstart</span>
<a name="ln-337"></a>  <span class="n">endif</span>
<a name="ln-338"></a>
<a name="ln-339"></a>  <span class="c">!! NOW OUR SOLUTION IS FULLY UPDATED SO UPDATE TIME VARIABLES TO MATCH...</span>
<a name="ln-340"></a>  <span class="n">it</span><span class="o">=</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">+</span><span class="n">dt</span><span class="p">;</span>
<a name="ln-341"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Moving on to time step (in sec):  &#39;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39;; end time of simulation:  &#39;</span><span class="p">,</span><span class="n">tdur</span>
<a name="ln-342"></a>  <span class="k">call </span><span class="n">dateinc</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">)</span>
<a name="ln-343"></a>
<a name="ln-344"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">modulo</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-345"></a>    <span class="c">!! print every 10th time step to avoid extreme amounts of console printing</span>
<a name="ln-346"></a>    <span class="k">print</span> <span class="s1">&#39;(A,I4,A1,I0.2,A1,I0.2,A1,F12.6,A5,F8.6)&#39;</span><span class="p">,</span> <span class="s1">&#39;Current time &#39;</span><span class="p">,</span><span class="n">ymd</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">ymd</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">ymd</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">UTsec</span><span class="p">,</span><span class="s1">&#39;; dt=&#39;</span><span class="p">,</span><span class="n">dt</span>
<a name="ln-347"></a>  <span class="n">endif</span>
<a name="ln-348"></a>
<a name="ln-349"></a>  <span class="c">!! OUTPUT</span>
<a name="ln-350"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">tout</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">    </span><span class="n">tout</span> <span class="o">=</span> <span class="n">tout</span> <span class="o">+</span> <span class="n">dtout</span>
<a name="ln-352"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">nooutput</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-353"></a><span class="k">      write</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;WARNING: skipping file output at sim time (sec)&#39;</span><span class="p">,</span><span class="n">t</span>
<a name="ln-354"></a>      <span class="k">cycle</span>
<a name="ln-355"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-356"></a>    <span class="c">!! close enough to warrant an output now...</span>
<a name="ln-357"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<a name="ln-358"></a>    <span class="k">call </span><span class="n">output_plasma</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="n">flagoutput</span><span class="p">,</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">,</span><span class="n">vs2</span><span class="p">,</span><span class="n">vs3</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">Ts</span><span class="p">,</span><span class="n">Phiall</span><span class="p">,</span><span class="n">J1</span><span class="p">,</span><span class="n">J2</span><span class="p">,</span><span class="n">J3</span><span class="p">)</span>
<a name="ln-359"></a>
<a name="ln-360"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">debug</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-361"></a><span class="k">      call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tfin</span><span class="p">)</span>
<a name="ln-362"></a>      <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Plasma output done for time step:  &#39;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39; in cpu_time of:  &#39;</span><span class="p">,</span><span class="n">tfin</span><span class="o">-</span><span class="n">tstart</span>
<a name="ln-363"></a>    <span class="n">endif</span>
<a name="ln-364"></a>  <span class="k">end if</span>
<a name="ln-365"></a>
<a name="ln-366"></a>  <span class="c">!! GLOW OUTPUT</span>
<a name="ln-367"></a>  <span class="k">if</span> <span class="p">((</span><span class="n">flagglow</span><span class="o">/=</span><span class="mi">0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">tglowout</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span> <span class="k">then</span> <span class="c">!same as plasma output</span>
<a name="ln-368"></a>    <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tstart</span><span class="p">)</span>
<a name="ln-369"></a>    <span class="k">call </span><span class="n">output_aur</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="n">flagglow</span><span class="p">,</span><span class="n">ymd</span><span class="p">,</span><span class="n">UTsec</span><span class="p">,</span><span class="n">iver</span><span class="p">)</span>
<a name="ln-370"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-371"></a><span class="k">      call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">tfin</span><span class="p">)</span>
<a name="ln-372"></a>      <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Auroral output done for time step:  &#39;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39; in cpu_time of: &#39;</span><span class="p">,</span><span class="n">tfin</span><span class="o">-</span><span class="n">tstart</span>
<a name="ln-373"></a>    <span class="k">end if</span>
<a name="ln-374"></a><span class="k">    </span><span class="n">tglowout</span><span class="o">=</span><span class="n">tglowout</span><span class="o">+</span><span class="n">dtglowout</span>
<a name="ln-375"></a>  <span class="k">end if</span>
<a name="ln-376"></a><span class="k">end do</span>
<a name="ln-377"></a>
<a name="ln-378"></a>
<a name="ln-379"></a><span class="c">!! DEALLOCATE MAIN PROGRAM DATA</span>
<a name="ln-380"></a><span class="k">deallocate</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span><span class="n">vs1</span><span class="p">,</span><span class="n">vs2</span><span class="p">,</span><span class="n">vs3</span><span class="p">,</span><span class="n">Ts</span><span class="p">)</span>
<a name="ln-381"></a><span class="k">deallocate</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">E3</span><span class="p">,</span><span class="n">J1</span><span class="p">,</span><span class="n">J2</span><span class="p">,</span><span class="n">J3</span><span class="p">)</span>
<a name="ln-382"></a><span class="k">deallocate</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="n">Tn</span><span class="p">,</span><span class="n">vn1</span><span class="p">,</span><span class="n">vn2</span><span class="p">,</span><span class="n">vn3</span><span class="p">)</span>
<a name="ln-383"></a>
<a name="ln-384"></a><span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">Phiall</span><span class="p">)</span>
<a name="ln-385"></a>
<a name="ln-386"></a><span class="k">if</span> <span class="p">(</span><span class="n">flagglow</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">iver</span><span class="p">)</span>
<a name="ln-387"></a>
<a name="ln-388"></a><span class="c">!! DEALLOCATE MODULE VARIABLES (MAY HAPPEN AUTOMATICALLY IN F2003???)</span>
<a name="ln-389"></a><span class="k">call </span><span class="n">clear_grid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-390"></a><span class="k">call </span><span class="n">clear_dneu</span><span class="p">()</span>
<a name="ln-391"></a><span class="k">call </span><span class="n">clear_precip_fileinput</span><span class="p">()</span>
<a name="ln-392"></a><span class="k">call </span><span class="n">clear_potential_fileinput</span><span class="p">()</span>
<a name="ln-393"></a>
<a name="ln-394"></a>
<a name="ln-395"></a><span class="c">!! SHUT DOWN MPI</span>
<a name="ln-396"></a><span class="n">ierr</span> <span class="o">=</span> <span class="n">mpibreakdown</span><span class="p">()</span>
<a name="ln-397"></a>
<a name="ln-398"></a><span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-399"></a><span class="k">  write</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;GEMINI: abnormal MPI shutdown code&#39;</span><span class="p">,</span> <span class="n">ierr</span><span class="p">,</span> <span class="s1">&#39;Process #&#39;</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span><span class="s1">&#39; /&#39;</span><span class="p">,</span><span class="n">lid</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-400"></a>  <span class="n">error</span> <span class="k">stop</span>
<a name="ln-401"></a><span class="n">endif</span>
<a name="ln-402"></a>
<a name="ln-403"></a><span class="k">call </span><span class="nb">date_and_time</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="nb">time</span><span class="p">)</span>
<a name="ln-404"></a><span class="k">print</span> <span class="s1">&#39;(/,A,I6,A,I6,3A)&#39;</span><span class="p">,</span> <span class="s1">&#39;GEMINI normal termination, Process #&#39;</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span><span class="s1">&#39; /&#39;</span><span class="p">,</span><span class="n">lid</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; at &#39;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="nb">time</span>
<a name="ln-405"></a>
<a name="ln-406"></a><span class="k">end program</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> GEMINI3D was developed by Matthew Zettergren
Guy Grubbs
Michael Hirsch</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    
  </body>
</html>